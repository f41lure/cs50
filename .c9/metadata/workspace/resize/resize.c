{"changed":true,"filter":false,"title":"resize.c","tooltip":"/resize/resize.c","value":"/**\n * Copies a BMP piece by piece, just because.\n */\n\n\n#include <stdio.h>\n#include <stdlib.h>\n\n#include \"bmp.h\"\n\n#define BMPHEAD 54\n\nint main(int argc, char *argv[])\n{\n    // ensure proper usage\n    if (argc != 4)\n    {\n        fprintf(stderr, \"Usage: ./resize n infile outfile\\n\");\n        return 1;\n    }\n\n    int n = atoi(argv[1]);\n    if (n < 0 || n > 100)\n    {\n        printf(\"Usage: ./resize n infile outfile\\n\");\n    }\n\n    // remember filenames\n    char *infile = argv[2];\n    char *outfile = argv[3];\n\n    // open input file\n    FILE *inptr = fopen(infile, \"r\");\n    if (inptr == NULL)\n    {\n        fprintf(stderr, \"Could not open %s.\\n\", infile);\n        return 2;\n    }\n\n    // open output file\n    FILE *outptr = fopen(outfile, \"w\");\n    if (outptr == NULL)\n    {\n        fclose(inptr);\n        fprintf(stderr, \"Could not create %s.\\n\", outfile);\n        return 3;\n    }\n\n    // read infile's BITMAPFILEHEADER\n    BITMAPFILEHEADER bf;\n    fread(&bf, sizeof(BITMAPFILEHEADER), 1, inptr);\n\n    // read infile's BITMAPINFOHEADER\n    BITMAPINFOHEADER bi;\n    fread(&bi, sizeof(BITMAPINFOHEADER), 1, inptr);\n\n    // ensure infile is (likely) a 24-bit uncompressed BMP 4.0\n    if (bf.bfType != 0x4d42 || bf.bfOffBits != 54 || bi.biSize != 40 ||\n        bi.biBitCount != 24 || bi.biCompression != 0)\n    {\n        fclose(outptr);\n        fclose(inptr);\n        fprintf(stderr, \"Unsupported file format.\\n\");\n        return 4;\n    }\n\n    int oldWidth = bi.biWidth;\n    int oldHeight = bi.biHeight;\n\n    bi.biWidth *= n;\n    bi.biHeight *= n;\n\n    // determine padding for scanlines\n    int oldpadding = (4 - (oldWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n    int padding = (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;\n\n    bi.biSizeImage = abs(bi.biHeight) * (bi.biWidth * sizeof(RGBTRIPLE) + padding);\n    bf.bfSize = (bi.biSizeImage + BMPHEAD);\n\n        // write outfile's BITMAPFILEHEADER\n    fwrite(&bf, sizeof(BITMAPFILEHEADER), 1, outptr);\n\n    // write outfile's BITMAPINFOHEADER\n    fwrite(&bi, sizeof(BITMAPINFOHEADER), 1, outptr);\n\n    // iterate over infile's scanlines\n    for (int i = 0; i < abs(oldHeight); i++)\n    {\n        // iterate over pixels in scanline\n        for (int j = 0; j < n; j++)\n        {\n            fseek(inptr, (BMPHEAD + ((oldWidth * 3 + oldpadding) * i)), SEEK_SET);\n            for (int a = 0; a < oldWidth; a++)\n            {\n                RGBTRIPLE triple;\n                // read RGB triple from infile\n                fread(&triple, sizeof(RGBTRIPLE), 1, inptr);\n                for (int b = 0; b < n; b++)\n                {\n                    // write RGB triple to outfile\n                    fwrite(&triple, sizeof(RGBTRIPLE), 1, outptr);\n                }\n\n            }\n            // then add it back (to demonstrate how)\n            for (int k = 0; k < padding; k++)\n            {\n                fputc(0x00, outptr);\n            }\n        }\n\n    }\n\n    // close infile\n    fclose(inptr);\n\n    // close outfile\n    fclose(outptr);\n\n    // success\n    return 0;\n}","undoManager":{"mark":99,"position":100,"stack":[[{"start":{"row":77,"column":35},"end":{"row":77,"column":36},"action":"remove","lines":["4"],"id":1744}],[{"start":{"row":77,"column":34},"end":{"row":77,"column":35},"action":"remove","lines":["5"],"id":1745}],[{"start":{"row":77,"column":34},"end":{"row":77,"column":35},"action":"insert","lines":["B"],"id":1746}],[{"start":{"row":77,"column":35},"end":{"row":77,"column":36},"action":"insert","lines":["H"],"id":1747}],[{"start":{"row":77,"column":36},"end":{"row":77,"column":37},"action":"insert","lines":["E"],"id":1748}],[{"start":{"row":77,"column":37},"end":{"row":77,"column":38},"action":"insert","lines":["A"],"id":1749}],[{"start":{"row":77,"column":38},"end":{"row":77,"column":39},"action":"insert","lines":["D"],"id":1750}],[{"start":{"row":77,"column":39},"end":{"row":77,"column":40},"action":"insert","lines":["E"],"id":1751}],[{"start":{"row":77,"column":40},"end":{"row":77,"column":41},"action":"insert","lines":["R"],"id":1752}],[{"start":{"row":89,"column":37},"end":{"row":89,"column":38},"action":"remove","lines":["h"],"id":1753}],[{"start":{"row":89,"column":36},"end":{"row":89,"column":37},"action":"remove","lines":["t"],"id":1754}],[{"start":{"row":89,"column":35},"end":{"row":89,"column":36},"action":"remove","lines":["d"],"id":1755}],[{"start":{"row":89,"column":34},"end":{"row":89,"column":35},"action":"remove","lines":["i"],"id":1756}],[{"start":{"row":89,"column":33},"end":{"row":89,"column":34},"action":"remove","lines":["W"],"id":1757}],[{"start":{"row":89,"column":32},"end":{"row":89,"column":33},"action":"remove","lines":["i"],"id":1758}],[{"start":{"row":89,"column":31},"end":{"row":89,"column":32},"action":"remove","lines":["b"],"id":1759}],[{"start":{"row":89,"column":30},"end":{"row":89,"column":31},"action":"remove","lines":["."],"id":1760}],[{"start":{"row":89,"column":29},"end":{"row":89,"column":30},"action":"remove","lines":["i"],"id":1761}],[{"start":{"row":89,"column":28},"end":{"row":89,"column":29},"action":"remove","lines":["b"],"id":1762}],[{"start":{"row":89,"column":28},"end":{"row":89,"column":29},"action":"insert","lines":["n"],"id":1763}],[{"start":{"row":86,"column":9},"end":{"row":86,"column":66},"action":"remove","lines":["int i = 0, biHeight = abs(bi.biHeight); i < biHeight; i++"],"id":1764},{"start":{"row":86,"column":9},"end":{"row":86,"column":45},"action":"insert","lines":["int i = 0; i < abs(firstHeight); i++"]}],[{"start":{"row":86,"column":32},"end":{"row":86,"column":33},"action":"remove","lines":["t"],"id":1765}],[{"start":{"row":86,"column":31},"end":{"row":86,"column":32},"action":"remove","lines":["s"],"id":1766}],[{"start":{"row":86,"column":30},"end":{"row":86,"column":31},"action":"remove","lines":["r"],"id":1767}],[{"start":{"row":86,"column":29},"end":{"row":86,"column":30},"action":"remove","lines":["i"],"id":1768}],[{"start":{"row":86,"column":29},"end":{"row":86,"column":30},"action":"insert","lines":["o"],"id":1769}],[{"start":{"row":86,"column":30},"end":{"row":86,"column":31},"action":"insert","lines":["l"],"id":1770}],[{"start":{"row":86,"column":31},"end":{"row":86,"column":32},"action":"insert","lines":["d"],"id":1771}],[{"start":{"row":86,"column":31},"end":{"row":86,"column":32},"action":"remove","lines":["d"],"id":1772}],[{"start":{"row":86,"column":30},"end":{"row":86,"column":31},"action":"remove","lines":["l"],"id":1773}],[{"start":{"row":86,"column":29},"end":{"row":86,"column":30},"action":"remove","lines":["o"],"id":1774}],[{"start":{"row":86,"column":28},"end":{"row":86,"column":29},"action":"remove","lines":["f"],"id":1775}],[{"start":{"row":86,"column":28},"end":{"row":86,"column":29},"action":"insert","lines":["o"],"id":1776}],[{"start":{"row":86,"column":29},"end":{"row":86,"column":30},"action":"insert","lines":["l"],"id":1777}],[{"start":{"row":86,"column":30},"end":{"row":86,"column":31},"action":"insert","lines":["d"],"id":1778}],[{"start":{"row":97,"column":44},"end":{"row":97,"column":45},"action":"remove","lines":["t"],"id":1779}],[{"start":{"row":97,"column":43},"end":{"row":97,"column":44},"action":"remove","lines":["h"],"id":1780}],[{"start":{"row":97,"column":42},"end":{"row":97,"column":43},"action":"remove","lines":["g"],"id":1781}],[{"start":{"row":97,"column":41},"end":{"row":97,"column":42},"action":"remove","lines":["i"],"id":1782}],[{"start":{"row":97,"column":40},"end":{"row":97,"column":41},"action":"remove","lines":["e"],"id":1783}],[{"start":{"row":97,"column":39},"end":{"row":97,"column":40},"action":"remove","lines":["H"],"id":1784}],[{"start":{"row":97,"column":39},"end":{"row":97,"column":40},"action":"insert","lines":["W"],"id":1785}],[{"start":{"row":97,"column":40},"end":{"row":97,"column":41},"action":"insert","lines":["i"],"id":1786}],[{"start":{"row":97,"column":41},"end":{"row":97,"column":42},"action":"insert","lines":["d"],"id":1787}],[{"start":{"row":97,"column":42},"end":{"row":97,"column":43},"action":"insert","lines":["t"],"id":1788}],[{"start":{"row":97,"column":43},"end":{"row":97,"column":44},"action":"insert","lines":["h"],"id":1789}],[{"start":{"row":97,"column":43},"end":{"row":97,"column":44},"action":"remove","lines":["h"],"id":1790}],[{"start":{"row":97,"column":42},"end":{"row":97,"column":43},"action":"remove","lines":["t"],"id":1791}],[{"start":{"row":97,"column":41},"end":{"row":97,"column":42},"action":"remove","lines":["d"],"id":1792}],[{"start":{"row":97,"column":40},"end":{"row":97,"column":41},"action":"remove","lines":["i"],"id":1793}],[{"start":{"row":97,"column":39},"end":{"row":97,"column":40},"action":"remove","lines":["W"],"id":1794}],[{"start":{"row":97,"column":38},"end":{"row":97,"column":39},"action":"remove","lines":["d"],"id":1795}],[{"start":{"row":97,"column":37},"end":{"row":97,"column":38},"action":"remove","lines":["l"],"id":1796}],[{"start":{"row":97,"column":36},"end":{"row":97,"column":37},"action":"remove","lines":["o"],"id":1797}],[{"start":{"row":97,"column":36},"end":{"row":97,"column":37},"action":"insert","lines":["n"],"id":1798}],[{"start":{"row":109,"column":28},"end":{"row":109,"column":29},"action":"insert","lines":["o"],"id":1799}],[{"start":{"row":109,"column":29},"end":{"row":109,"column":30},"action":"insert","lines":["l"],"id":1800}],[{"start":{"row":109,"column":30},"end":{"row":109,"column":31},"action":"insert","lines":["d"],"id":1801}],[{"start":{"row":109,"column":30},"end":{"row":109,"column":31},"action":"remove","lines":["d"],"id":1802}],[{"start":{"row":109,"column":29},"end":{"row":109,"column":30},"action":"remove","lines":["l"],"id":1803}],[{"start":{"row":109,"column":28},"end":{"row":109,"column":29},"action":"remove","lines":["o"],"id":1804}],[{"start":{"row":105,"column":0},"end":{"row":106,"column":40},"action":"remove","lines":["        // skip over padding, if any","        fseek(inptr, padding, SEEK_CUR);"],"id":1805}],[{"start":{"row":104,"column":0},"end":{"row":105,"column":0},"action":"remove","lines":["",""],"id":1806}],[{"start":{"row":105,"column":0},"end":{"row":110,"column":9},"action":"remove","lines":["","        // then add it back (to demonstrate how)","        for (int k = 0; k < padding; k++)","        {","            fputc(0x00, outptr);","        }"],"id":1807}],[{"start":{"row":104,"column":0},"end":{"row":105,"column":0},"action":"remove","lines":["",""],"id":1808}],[{"start":{"row":101,"column":17},"end":{"row":102,"column":0},"action":"insert","lines":["",""],"id":1809},{"start":{"row":102,"column":0},"end":{"row":102,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":102,"column":16},"end":{"row":103,"column":0},"action":"insert","lines":["",""],"id":1810},{"start":{"row":103,"column":0},"end":{"row":103,"column":16},"action":"insert","lines":["                "]}],[{"start":{"row":103,"column":16},"end":{"row":108,"column":9},"action":"insert","lines":["","        // then add it back (to demonstrate how)","        for (int k = 0; k < padding; k++)","        {","            fputc(0x00, outptr);","        }"],"id":1811}],[{"start":{"row":104,"column":8},"end":{"row":104,"column":12},"action":"insert","lines":["    "],"id":1812}],[{"start":{"row":105,"column":9},"end":{"row":105,"column":12},"action":"insert","lines":["   "],"id":1813}],[{"start":{"row":105,"column":11},"end":{"row":105,"column":12},"action":"remove","lines":[" "],"id":1814}],[{"start":{"row":105,"column":10},"end":{"row":105,"column":11},"action":"remove","lines":[" "],"id":1815}],[{"start":{"row":105,"column":9},"end":{"row":105,"column":10},"action":"remove","lines":[" "],"id":1816}],[{"start":{"row":105,"column":8},"end":{"row":105,"column":12},"action":"insert","lines":["    "],"id":1817}],[{"start":{"row":106,"column":8},"end":{"row":106,"column":12},"action":"insert","lines":["    "],"id":1818}],[{"start":{"row":107,"column":8},"end":{"row":107,"column":12},"action":"insert","lines":["    "],"id":1819}],[{"start":{"row":108,"column":8},"end":{"row":108,"column":12},"action":"insert","lines":["    "],"id":1820}],[{"start":{"row":109,"column":12},"end":{"row":109,"column":16},"action":"insert","lines":["    "],"id":1821}],[{"start":{"row":109,"column":12},"end":{"row":109,"column":16},"action":"remove","lines":["    "],"id":1822}],[{"start":{"row":109,"column":8},"end":{"row":109,"column":12},"action":"remove","lines":["    "],"id":1823}],[{"start":{"row":104,"column":12},"end":{"row":104,"column":16},"action":"insert","lines":["    "],"id":1824}],[{"start":{"row":105,"column":12},"end":{"row":105,"column":16},"action":"insert","lines":["    "],"id":1825}],[{"start":{"row":106,"column":12},"end":{"row":106,"column":16},"action":"insert","lines":["    "],"id":1826}],[{"start":{"row":107,"column":16},"end":{"row":107,"column":20},"action":"insert","lines":["    "],"id":1827}],[{"start":{"row":108,"column":12},"end":{"row":108,"column":16},"action":"insert","lines":["    "],"id":1828}],[{"start":{"row":109,"column":8},"end":{"row":109,"column":12},"action":"insert","lines":["    "],"id":1829}],[{"start":{"row":102,"column":0},"end":{"row":102,"column":16},"action":"remove","lines":["                "],"id":1830},{"start":{"row":103,"column":0},"end":{"row":103,"column":16},"action":"remove","lines":["                "]}],[{"start":{"row":104,"column":0},"end":{"row":108,"column":17},"action":"remove","lines":["                // then add it back (to demonstrate how)","                for (int k = 0; k < padding; k++)","                {","                    fputc(0x00, outptr);","                }"],"id":1831}],[{"start":{"row":103,"column":0},"end":{"row":104,"column":0},"action":"remove","lines":["",""],"id":1832}],[{"start":{"row":102,"column":0},"end":{"row":103,"column":0},"action":"remove","lines":["",""],"id":1833}],[{"start":{"row":103,"column":13},"end":{"row":104,"column":0},"action":"insert","lines":["",""],"id":1834},{"start":{"row":104,"column":0},"end":{"row":104,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":104,"column":12},"end":{"row":108,"column":17},"action":"insert","lines":["                // then add it back (to demonstrate how)","                for (int k = 0; k < padding; k++)","                {","                    fputc(0x00, outptr);","                }"],"id":1835}],[{"start":{"row":104,"column":24},"end":{"row":104,"column":28},"action":"remove","lines":["    "],"id":1836}],[{"start":{"row":104,"column":20},"end":{"row":104,"column":24},"action":"remove","lines":["    "],"id":1837}],[{"start":{"row":104,"column":16},"end":{"row":104,"column":20},"action":"remove","lines":["    "],"id":1838}],[{"start":{"row":104,"column":12},"end":{"row":104,"column":16},"action":"remove","lines":["    "],"id":1839}],[{"start":{"row":105,"column":12},"end":{"row":105,"column":16},"action":"remove","lines":["    "],"id":1840}],[{"start":{"row":106,"column":12},"end":{"row":106,"column":16},"action":"remove","lines":["    "],"id":1841}],[{"start":{"row":107,"column":16},"end":{"row":107,"column":20},"action":"remove","lines":["    "],"id":1842}],[{"start":{"row":108,"column":12},"end":{"row":108,"column":16},"action":"remove","lines":["    "],"id":1843}],[{"start":{"row":10,"column":8},"end":{"row":10,"column":15},"action":"remove","lines":["BHEADER"],"id":1844},{"start":{"row":10,"column":8},"end":{"row":10,"column":15},"action":"insert","lines":["BMPHEAD"]},{"start":{"row":77,"column":34},"end":{"row":77,"column":41},"action":"remove","lines":["BHEADER"]},{"start":{"row":77,"column":34},"end":{"row":77,"column":41},"action":"insert","lines":["BMPHEAD"]},{"start":{"row":91,"column":26},"end":{"row":91,"column":33},"action":"remove","lines":["BHEADER"]},{"start":{"row":91,"column":26},"end":{"row":91,"column":33},"action":"insert","lines":["BMPHEAD"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":10,"column":18},"end":{"row":10,"column":18},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1505313328162}