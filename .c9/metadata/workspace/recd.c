{"filter":false,"title":"recd.c","tooltip":"/recd.c","undoManager":{"mark":9,"position":9,"stack":[[{"start":{"row":0,"column":0},"end":{"row":66,"column":1},"action":"insert","lines":["/**","* recover.c","*","* Computer Science 50","* Problem Set 4","*","* Recovers JPEGs from a forensic image.","*/","","#include <stdio.h>","#include <stdint.h>","","typedef uint8_t BYTE;","","int main(int argc, char* argv[])","{","    // open the JPEG file","    FILE* file = fopen(\"card.raw\", \"r\");","","    // initiate the counter","    int counter = 0;","","    // initiate buffer","    BYTE buffer[512];","","    // three-digit decimal number from 000 on up","    char lname[10];","","    // declare a temp file","    FILE* temp = NULL;","","    // repeat until the end of the card","    while(!feof(file))","    {","      // check if it is the begging of a JPEG file","        if (buffer[0] == 0xff && buffer[1] == 0xd8 && buffer[2] == 0xff && (buffer[3] == 0xe0 || buffer[3] == 0xe1))","        {","            if (temp != NULL)","                fclose(temp);","","            // label the files with three digits","            sprintf(lname, \"%03d.jpg\", counter);","","            // next file in line","            temp = fopen(lname, \"w\");","","            // update the counter","            counter++;","","            // create a new file","            fwrite(buffer, sizeof(buffer), 1, temp);","        }","      else if (counter > 0)","        {","            fwrite(buffer, sizeof(buffer), 1, temp);","      }","","        fread(buffer, sizeof(buffer), 1, file);","","    }","","    // close file","    fclose(file);","","    // that's all folks","    return 0;","}"],"id":1}],[{"start":{"row":16,"column":0},"end":{"row":17,"column":40},"action":"remove","lines":["    // open the JPEG file","    FILE* file = fopen(\"card.raw\", \"r\");"],"id":2}],[{"start":{"row":16,"column":0},"end":{"row":34,"column":0},"action":"insert","lines":["    int jpg_ctr = 0;","    // ensure proper usage","    if (argc != 2)","    {","        fprintf(stderr, \"Usage: ./recover jpeg\\n\");","        return 1;","    }","","    // remember filenames","    char *pfile_n = argv[1];","","    // open input file","    FILE *pfile = fopen(pfile_n, \"r\");","    if (pfile == NULL)","    {","        fprintf(stderr, \"Could not open %s.\\n\", pfile_n);","        return 2;","    }",""],"id":3}],[{"start":{"row":16,"column":1},"end":{"row":16,"column":20},"action":"remove","lines":["   int jpg_ctr = 0;"],"id":4}],[{"start":{"row":16,"column":0},"end":{"row":16,"column":1},"action":"remove","lines":[" "],"id":5}],[{"start":{"row":15,"column":1},"end":{"row":16,"column":0},"action":"remove","lines":["",""],"id":6}],[{"start":{"row":27,"column":10},"end":{"row":27,"column":11},"action":"remove","lines":["p"],"id":7}],[{"start":{"row":28,"column":8},"end":{"row":28,"column":9},"action":"remove","lines":["p"],"id":8}],[{"start":{"row":30,"column":48},"end":{"row":30,"column":49},"action":"remove","lines":["p"],"id":9}],[{"start":{"row":30,"column":48},"end":{"row":30,"column":49},"action":"insert","lines":["p"],"id":10}]]},"ace":{"folds":[],"scrolltop":613,"scrollleft":0,"selection":{"start":{"row":30,"column":49},"end":{"row":30,"column":49},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":42,"state":"start","mode":"ace/mode/c_cpp"}},"timestamp":1504522828555,"hash":"b91c69359dff34a33acdef4b4ecb145be6a15f60"}